<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/informationFavicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/style.css">
    <title><%= guide.title %></title>
</head>
<body>
    <div class="main-content">
        <div class="guidePage">
            <div class="sidebar">
                <div class="sidebarLinks">
                    <a href="/">Home</a>
                    <% if (user) { %>
                        <% if (user.id == guide.userId.id) { %>
                            <a href="/guide/<%= guide._id %>/edit">Edit Guide</a>
                        <% } %>
                        <a href="/logout">Log Out</a>
                        <a href="/dashboard">Dashboard</a>
                    <% } else { %>
                        <a href="/login">Log In</a>
                    <% } %>
                    
                    <h3>Sections</h3>
                    <% for (let i = 0; i < guide.sections.length; i++) { %>
                        <a href="#section-<%= i %>"><%= guide.sections[i].header %></a>
                    <% } %>
                </div>
            </div>
            <div class="guideContent guideWSidebar">
                <h1><%= guide.title %></h1> <!-- Display the guide title -->
                <p><strong>Tag:</strong> <%= guide.tag %></p> <!-- Display the guide tag -->
                
                <!-- Loop through the sections to display headers, descriptions, and images -->
                <% for (let i = 0; i < guide.sections.length; i++) { %>
                    <div class="section" id="section-<%= i %>"> <!-- Add an ID for scrolling -->
                        <h2><%= guide.sections[i].header %></h2> <!-- Section header -->
                        <p><%= guide.sections[i].description %></p> <!-- Section description -->
                        <% if (guide.sections[i].image) { %>
                            <img src="/uploads/<%= guide.sections[i].image %>" class="guideImage" alt="<%= guide.sections[i].header %> image"> <!-- Section image -->
                        <% } %>
                    </div>
                <% } %>

                <div class="guide-creator">
                    <h4>Created by: <%= guide.userId.email %></h4> <!-- Assuming you want to show the email -->
                </div>

                
            </div>
        </div>
    </div>
    <script>
        // Check if the URL contains the alert query parameter
        const urlParams = new URLSearchParams(window.location.search);
      
        if (urlParams.has('alert')) {
          const alertType = urlParams.get('alert');
      
          if (alertType === 'sessionExpired') {
            alert('Your session has expired. Please log in again.');
          } else if (alertType === 'invalidToken') {
            alert('Invalid session. Please log in again.');
          }
        }
      </script>

</body>
</html>